var ApplicationConfiguration=function(){"use strict";var a="freelancemanager",b=["ngRoute","ngAnimate","ngStorage","ngCookies","pascalprecht.translate","ui.bootstrap","ui.router","ui.utils","oc.lazyLoad","cfp.loadingBar","ngSanitize","ngResource"],c=function(b){var c=angular.module(b,[]);return angular.module(a).requires.push(b),c},d=function(){var a=arguments;return{deps:["$ocLazyLoad","$q","APP_REQUIRES",function(b,c,d){function e(a){return g.then("function"==typeof a?a:function(){var c=f(a);return c?b.load(c):$.error("Route resolve: Bad resource name ["+a+"]")})}function f(a){if(d.modules)for(var b in d.modules)if(d.modules[b].name&&d.modules[b].name===a)return d.modules[b];return d.scripts&&d.scripts[a]}for(var g=c.when(1),h=0,i=a.length;i>h;h++)g=e(a[h]);return g}]}};return{applicationModuleName:a,applicationModuleVendorDependencies:b,registerModule:c,resolve:d}}();angular.module(ApplicationConfiguration.applicationModuleName,ApplicationConfiguration.applicationModuleVendorDependencies),angular.module(ApplicationConfiguration.applicationModuleName).config(["$locationProvider",function(a){a.hashPrefix("!")}]),angular.element(document).ready(function(){angular.bootstrap(document,[ApplicationConfiguration.applicationModuleName])}),ApplicationConfiguration.registerModule("account");var App=ApplicationConfiguration.registerModule("angle");ApplicationConfiguration.registerModule("core"),ApplicationConfiguration.registerModule("crm"),ApplicationConfiguration.registerModule("project"),ApplicationConfiguration.registerModule("time"),angular.module("account",["angular-jwt"]).factory("authInterceptor",["$rootScope","$q","$window",function(a,b,c){"use strict";return{request:function(a){return a.headers=a.headers||{},c.localStorage.token&&(a.headers.Authorization="Bearer "+c.localStorage.token),a},response:function(a){return 401===a.status,a||b.when(a)}}}]).config(["$httpProvider",function(a){"use strict";a.interceptors.push("authInterceptor")}]).run(["$rootScope","$location","$window","jwtHelper",function(a,b,c,d){"use strict";a.$on("$stateChangeStart",function(a,e){var f=c.localStorage.token&&!d.isTokenExpired(c.localStorage.token);e.access&&e.access.requiredLogin&&!f&&b.path("/login")})}]),angular.module("account").config(["$stateProvider",function(a){"use strict";a.state("login",{url:"/login",templateUrl:"modules/account/views/login.html"}).state("app.account",{url:"/account",templateUrl:"modules/account/views/account.html",access:{requiredLogin:!0}})}]),angular.module("account").controller("AccountInfoController",["$scope","$window","jwtHelper","Account",function(a,b,c,d){"use strict";var e=c.decodeToken(b.localStorage.token);d.get({id:e.id}).$promise.then(function(b){a.account=b}),a.save=function(){d.save(e.id,a.account)}}]),angular.module("account").controller("AuthenticateController",["$rootScope","$scope","$http","$window","$location","jwtHelper",function(a,b,c,d,e,f){"use strict";b.user={email:"",password:""},b.error="",b.submit=function(){c.post("/security/authenticate",b.user).success(function(a){var b=f.decodeToken(a.token);d.localStorage.user=b.fullName,d.localStorage.token=a.token,e.path("/")}).error(function(){delete d.localStorage.token,delete a.$storage.user,b.error="Invalid email or password"})}}]),App.config(["$stateProvider","$urlRouterProvider","$controllerProvider","$compileProvider","$filterProvider","$provide","$ocLazyLoadProvider","APP_REQUIRES",function(a,b,c,d,e,f,g,h){"use strict";App.controller=c.register,App.directive=d.directive,App.filter=e.register,App.factory=f.factory,App.service=f.service,App.constant=f.constant,App.value=f.value,g.config({debug:!1,events:!0,modules:h.modules})}]).config(["$translateProvider",function(a){a.useStaticFilesLoader({prefix:"i18n/",suffix:".json"}),a.preferredLanguage("en"),a.useLocalStorage()}]).config(["cfpLoadingBarProvider",function(a){a.includeBar=!0,a.includeSpinner=!1,a.latencyThreshold=500,a.parentSelector=".wrapper > section"}]).controller("NullController",function(){}).run(["$rootScope","$state","$stateParams","$window","$templateCache",function(a,b,c,d){a.$state=b,a.$stateParams=c,a.$storage=d.localStorage,a.app={name:"Freelance Manager",description:"A demo application in NodeJS",author:"Kevin Cornelis",year:(new Date).getFullYear(),layout:{isFixed:!0,isCollapsed:!1,isBoxed:!1,isRTL:!1},viewAnimation:"ng-fadeInUp"}}]),App.constant("APP_COLORS",{primary:"#5d9cec",success:"#27c24c",info:"#23b7e5",warning:"#ff902b",danger:"#f05050",inverse:"#131e26",green:"#37bc9b",pink:"#f532e5",purple:"#7266ba",dark:"#3a3f51",yellow:"#fad732","gray-darker":"#232735","gray-dark":"#3a3f51",gray:"#dde6e9","gray-light":"#e4eaec","gray-lighter":"#edf1f2"}).constant("APP_MEDIAQUERY",{desktopLG:1200,desktop:992,tablet:768,mobile:480}).constant("APP_REQUIRES",{scripts:{whirl:["lib/whirl/dist/whirl.css"],classyloader:["lib/jquery-classyloader/js/jquery.classyloader.min.js"],animo:["lib/animo.js/animo.js"],fastclick:["lib/fastclick/lib/fastclick.js"],modernizr:["lib/modernizr/modernizr.js"],animate:["lib/animate.css/animate.min.css"],icons:["lib/skycons/skycons.js","lib/fontawesome/css/font-awesome.min.css","lib/simple-line-icons/css/simple-line-icons.css","lib/weather-icons/css/weather-icons.min.css"],sparklines:["unmanagedbowerlib/sparklines/jquery.sparkline.min.js"],slider:["lib/seiyria-bootstrap-slider/dist/bootstrap-slider.min.js","lib/seiyria-bootstrap-slider/dist/css/bootstrap-slider.min.css"],wysiwyg:["lib/bootstrap-wysiwyg/bootstrap-wysiwyg.js","lib/bootstrap-wysiwyg/external/jquery.hotkeys.js"],slimscroll:["lib/slimScroll/jquery.slimscroll.min.js"],screenfull:["lib/screenfull/dist/screenfull.min.js"],"vector-map":["lib/ika.jvectormap/jquery-jvectormap-1.2.2.min.js","lib/ika.jvectormap/jquery-jvectormap-world-mill-en.js","lib/ika.jvectormap/jquery-jvectormap-us-mill-en.js","lib/ika.jvectormap/jquery-jvectormap-1.2.2.css"],loadGoogleMapsJS:["unmanagedbowerlib/gmap/load-google-maps.js"],"google-map":["lib/jQuery-gMap/jquery.gmap.min.js"],"flot-chart":["lib/Flot/jquery.flot.js"],"flot-chart-plugins":["lib/flot.tooltip/js/jquery.flot.tooltip.min.js","lib/Flot/jquery.flot.resize.js","lib/Flot/jquery.flot.pie.js","lib/Flot/jquery.flot.time.js","lib/Flot/jquery.flot.categories.js","lib/flot-spline/js/jquery.flot.spline.min.js"],"jquery-ui":["lib/jquery-ui/ui/core.js","lib/jquery-ui/ui/widget.js"],"jquery-ui-widgets":["lib/jquery-ui/ui/core.js","lib/jquery-ui/ui/widget.js","lib/jquery-ui/ui/mouse.js","lib/jquery-ui/ui/draggable.js","lib/jquery-ui/ui/droppable.js","lib/jquery-ui/ui/sortable.js","lib/jqueryui-touch-punch/jquery.ui.touch-punch.min.js"],moment:["lib/moment/min/moment-with-locales.min.js"],inputmask:["lib/jquery.inputmask/dist/jquery.inputmask.bundle.min.js"],flatdoc:["lib/flatdoc/flatdoc.js"],codemirror:["lib/codemirror/lib/codemirror.js","lib/codemirror/lib/codemirror.css"],"codemirror-plugins":["lib/codemirror/addon/mode/overlay.js","lib/codemirror/mode/markdown/markdown.js","lib/codemirror/mode/xml/xml.js","lib/codemirror/mode/gfm/gfm.js","lib/marked/lib/marked.js"],taginput:["lib/bootstrap-tagsinput/dist/bootstrap-tagsinput.css","lib/bootstrap-tagsinput/dist/bootstrap-tagsinput.min.js"],filestyle:["lib/bootstrap-filestyle/src/bootstrap-filestyle.js"],parsley:["lib/parsleyjs/dist/parsley.min.js"],datatables:["lib/datatables/media/js/jquery.dataTables.min.js","unmanagedbowerlib/datatable-bootstrap/css/dataTables.bootstrap.css"],"datatables-pugins":["unmanagedbowerlib/datatable-bootstrap/js/dataTables.bootstrap.js","unmanagedbowerlib/datatable-bootstrap/js/dataTables.bootstrapPagination.js","lib/datatables-colvis/js/dataTables.colVis.js","lib/datatables-colvis/css/dataTables.colVis.css"],fullcalendar:["lib/fullcalendar/dist/fullcalendar.min.js","lib/fullcalendar/dist/fullcalendar.css"],gcal:["lib/fullcalendar/dist/gcal.js"],datetime:["lib/clockpicker/dist/bootstrap-clockpicker.css","lib/bootstrap-datepicker/css/datepicker3.css","lib/clockpicker/dist/bootstrap-clockpicker.js","lib/bootstrap-datepicker/js/bootstrap-datepicker.js"],excel:["lib/js-xlsx/dist/xlsx.core.min.js"]},modules:[{name:"toaster",files:["lib/angularjs-toaster/toaster.js","lib/angularjs-toaster/toaster.css"]},{name:"localytics.directives",files:["lib/chosen_v1.2.0/chosen.jquery.min.js","lib/chosen_v1.2.0/chosen.min.css","lib/angular-chosen-localytics/chosen.js"]},{name:"ngDialog",files:["lib/ngDialog/js/ngDialog.min.js","lib/ngDialog/css/ngDialog.min.css","lib/ngDialog/css/ngDialog-theme-default.min.css"]},{name:"ngWig",files:["lib/ngWig/dist/ng-wig.min.js"]},{name:"ngTable",files:["lib/ng-table/ng-table.min.js","lib/ng-table/ng-table.min.css"]},{name:"ngTableExport",files:["lib/ng-table-export/ng-table-export.js"]}]}),App.controller("AppController",["$rootScope","$scope","$state","$translate","$window","$localStorage","$timeout","toggleStateService","colors","browser","cfpLoadingBar",function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l;a.$on("$stateChangeStart",function(){$(".wrapper > section").length&&!l&&k.start(),l=1}),a.$on("$stateChangeSuccess",function(a){a.targetScope.$watch("$viewContentLoaded",function(){k.complete(),l=null})}),a.$on("$stateNotFound",function(a,b){console.log(b.to),console.log(b.toParams),console.log(b.options)}),a.$on("$stateChangeError",function(a,b,c,d,e,f){console.log(f)}),a.$on("$stateChangeSuccess",function(){e.scrollTo(0,0),a.currTitle=c.current.title}),a.currTitle=c.current.title,a.pageTitle=function(){return a.app.name+" - "+(a.currTitle||a.app.description)},a.$watch("app.layout.isCollapsed",function(b){b===!1&&a.$broadcast("closeSidebarMenu")}),angular.isDefined(f.layout)?b.app.layout=f.layout:f.layout=b.app.layout,a.$watch("app.layout",function(){f.layout=b.app.layout},!0),b.colorByName=i.byName,b.toggleUserBlock=function(){b.$broadcast("toggleUserBlock")},b.language={listIsOpen:!1,available:{en:"English"},init:function(){var a=d.proposedLanguage()||d.use(),c=d.preferredLanguage();b.language.selected=b.language.available[a||c]},set:function(a){d.use(a),b.language.selected=b.language.available[a],b.language.listIsOpen=!b.language.listIsOpen}},b.language.init(),h.restoreState($(document.body)),g(function(){a.mainViewAnimation=a.app.viewAnimation}),a.cancel=function(a){a.stopPropagation()}}]),App.controller("SidebarController",["$rootScope","$scope","$state","$location","$http","$timeout","APP_MEDIAQUERY",function(a,b,c,d,e,f,g){function h(){return k.width()<g.tablet}function i(){return l.hasClass("aside-collapsed")}var j=a.$state.current.name,k=$(window),l=($("html"),$("body"));a.$on("$stateChangeStart",function(b,c){j=c.name,$("body.aside-toggled").removeClass("aside-toggled"),a.$broadcast("closeSidebarMenu")}),k.on("resize",function(){l.removeClass(h()?"aside-collapsed":"aside-toggled")});var m=function(a){if(a){if(a.sref&&"#"!=a.sref)return c.is(a.sref)||c.includes(a.sref);var b=!1;return angular.forEach(a.submenu,function(a){m(a)&&(b=!0)}),b}};b.getMenuItemPropClasses=function(a){return(a.heading?"nav-heading":"")+(m(a)?" active":"")},b.loadSidebarMenu=function(){var b="settings/sidebar-menu.json",c=b+"?v="+(new Date).getTime();e.get(c).success(function(b){a.menuItems=b}).error(function(){alert("Failure loading menu")})},b.loadSidebarMenu();var n=[];b.addCollapse=function(a,b){n[a]=!m(b)},b.isCollapse=function(a){return n[a]},b.toggleCollapse=function(a,b){function c(a){a+="";for(var b in n)(0>a||a.indexOf(b)<0)&&(n[b]=!0)}return i()&&!h()?!0:(angular.isDefined(n[a])?(n[a]=!n[a],c(a)):b&&c(-1),!0)}}]),App.directive("href",function(){return{restrict:"A",compile:function(a,b){return function(a,c){(b.ngClick||""===b.href||"#"===b.href)&&(c.hasClass("dropdown-toggle")||c.on("click",function(a){a.preventDefault(),a.stopPropagation()}))}}}}),App.directive("animateEnabled",["$animate",function(a){return{link:function(b,c,d){b.$watch(function(){return b.$eval(d.animateEnabled,b)},function(b){a.enabled(!!b,c)})}}}]),App.directive("classyloader",function(a){"use strict";var b=$(window),c="js-is-in-view";return{restrict:"A",link:function(d,e){function f(a,b){var d=-20;!a.hasClass(c)&&$.Utils.isInView(a,{topoffset:d})&&g(a,b)}function g(a,b){a.ClassyLoader(b).addClass(c)}a(function(){var a=$(e),c=a.data();c&&(c.triggerInView?(b.scroll(function(){f(a,c)}),f(a,c)):g(a,c))},0)}}}),App.directive("resetKey",["$state","$rootScope",function(a,b){"use strict";return{restrict:"A",scope:{resetKey:"="},link:function(a,b,c){a.resetKey=c.resetKey},controller:function(c,d){d.on("click",function(d){d.preventDefault(),c.resetKey?(delete b.$storage[c.resetKey],a.go(a.current,{},{reload:!0})):$.error("No storage key specified for reset.")})}}}]),App.directive("filestyle",function(){return{restrict:"A",controller:function(a,b){var c=$(b);c.filestyle({classInput:c.data("classinput")})}}}),App.directive("flatdoc",["$location",function(){return{restrict:"EA",template:"<div role='flatdoc'><div role='flatdoc-menu'></div><div role='flatdoc-content'></div></div>",link:function(a,b,c){Flatdoc.run({fetcher:Flatdoc.file(c.src)});var d=$("html, body");$(document).on("flatdoc:ready",function(){var a=$('[role="flatdoc-menu"]');a.find("a").on("click",function(b){b.preventDefault(),b.stopPropagation();var c=$(this);a.find("a.active").removeClass("active"),c.addClass("active"),d.animate({scrollTop:$(this.getAttribute("href")).offset().top-($(".topnavbar").height()+10)},800)})})}}}]),App.directive("formWizard",function(a){"use strict";function b(a,b,c){var d=this;d.quantity=parseInt(a,10),d.validate=b,d.element=c,d.init=function(){return d.createsteps(d.quantity),d.go(1),d},d.go=function(a){if(angular.isDefined(d.steps[a])){if(d.validate&&1!==a){var b=$(d.element),c=b.children().children("div").get(a-2);if(!1===b.parsley().validate(c.id))return!1}d.cleanall(),d.steps[a]=!0}},d.active=function(a){return!!d.steps[a]},d.cleanall=function(){for(var a in d.steps)d.steps[a]=!1},d.createsteps=function(a){d.steps=[];for(var b=1;a>=b;b++)d.steps[b]=!1}}return{restrict:"EA",scope:!0,link:function(c,d,e){var f=a(e.validateSteps)(c),g=new b(e.steps,!!f,d);c.wizard=g.init()}}}),App.directive("toggleFullscreen",function(){"use strict";return{restrict:"A",link:function(a,b){b.on("click",function(a){a.preventDefault(),screenfull.enabled?(screenfull.toggle(),screenfull.isFullscreen?$(this).children("em").removeClass("fa-expand").addClass("fa-compress"):$(this).children("em").removeClass("fa-compress").addClass("fa-expand")):$.error("Fullscreen not enabled")})}}}),App.directive("gmap",["$window","gmap",function(a,b){"use strict";var c=[{featureType:"water",stylers:[{visibility:"on"},{color:"#bdd1f9"}]},{featureType:"all",elementType:"labels.text.fill",stylers:[{color:"#334165"}]},{featureType:"landscape",stylers:[{color:"#e9ebf1"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#c5c6c6"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#fff"}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#fff"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#d8dbe0"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#cfd5e0"}]},{featureType:"administrative",stylers:[{visibility:"on"},{lightness:33}]},{featureType:"poi.park",elementType:"labels",stylers:[{visibility:"on"},{lightness:20}]},{featureType:"road",stylers:[{color:"#d8dbe0",lightness:20}]}];return b.setStyle(c),$(a).resize(function(){b.autocenter()}),{restrict:"A",link:function(a,c){b.init(c)}}}]),App.directive("loadCss",function(){"use strict";function a(a){var b="autoloaded-stylesheet",c=$("#"+b).attr("id",b+"-old");return $("head").append($("<link/>").attr({id:b,rel:"stylesheet",href:a})),c.length&&c.remove(),$("#"+b)}return{restrict:"A",link:function(b,c,d){c.on("click",function(b){c.is("a")&&b.preventDefault();var e,f=d.loadCss;f?(e=a(f),e||$.error("Error creating stylesheet link element.")):$.error("No stylesheet location defined.")})}}}),App.directive("markdownarea",function(){"use strict";return{restrict:"A",link:function(a,b,c){{var d=$(b),e=$.fn.markdownarea;$.Utils.options(c.markdownarea),new e(d,$.Utils.options(c.markdownarea))}}}}),function(a,b,c){"use strict";var d=function(b,c){var e=a(b);e.data("markdownarea")||(this.element=e,this.options=a.extend({},d.defaults,c),this.marked=this.options.marked||marked,this.CodeMirror=this.options.CodeMirror||CodeMirror,this.marked.setOptions({gfm:!0,tables:!0,breaks:!0,pedantic:!0,sanitize:!1,smartLists:!0,smartypants:!1,langPrefix:"lang-"}),this.init(),this.element.data("markdownarea",this))};a.extend(d.prototype,{init:function(){var c=this,e=d.template;e=e.replace(/\{\:lblPreview\}/g,this.options.lblPreview),e=e.replace(/\{\:lblCodeview\}/g,this.options.lblCodeview),this.markdownarea=a(e),this.content=this.markdownarea.find(".uk-markdownarea-content"),this.toolbar=this.markdownarea.find(".uk-markdownarea-toolbar"),this.preview=this.markdownarea.find(".uk-markdownarea-preview").children().eq(0),this.code=this.markdownarea.find(".uk-markdownarea-code"),this.element.before(this.markdownarea).appendTo(this.code),this.editor=this.CodeMirror.fromTextArea(this.element[0],this.options.codemirror),this.editor.markdownarea=this,this.editor.on("change",function(){var b=function(){var a=c.editor.getValue();c.currentvalue=String(a),c.element.trigger("markdownarea-before",[c]),c.applyPlugins(),c.marked(c.currentvalue,function(a,b){if(a)throw a;c.preview.html(b),c.element.val(c.editor.getValue()).trigger("markdownarea-update",[c])})};return b(),a.Utils.debounce(b,150)}()),this.code.find(".CodeMirror").css("height",this.options.height),this._buildtoolbar(),this.fit(),a(b).on("resize",a.Utils.debounce(function(){c.fit()},200));var f=c.preview.parent(),g=this.code.find(".CodeMirror-sizer"),h=this.code.find(".CodeMirror-scroll").on("scroll",a.Utils.debounce(function(){if("tab"!=c.markdownarea.attr("data-mode")){var a=g.height()-h.height(),b=f[0].scrollHeight-f.height(),d=b/a,e=h.scrollTop()*d;f.scrollTop(e)}},10));this.markdownarea.on("click",".uk-markdown-button-markdown, .uk-markdown-button-preview",function(b){b.preventDefault(),"tab"==c.markdownarea.attr("data-mode")&&(c.markdownarea.find(".uk-markdown-button-markdown, .uk-markdown-button-preview").removeClass("uk-active").filter(this).addClass("uk-active"),c.activetab=a(this).hasClass("uk-markdown-button-markdown")?"code":"preview",c.markdownarea.attr("data-active-tab",c.activetab))}),this.preview.parent().css("height",this.code.height())},applyPlugins:function(){var a=this,b=Object.keys(d.plugins),c=d.plugins;if(this.markers={},b.length){var e=this.currentvalue.split("\n");b.forEach(function(a){this.markers[a]=[]},this);for(var f=0,g=e.length;g>f;f++)!function(d){b.forEach(function(b){var f=0;e[d]=e[d].replace(c[b].identifier,function(){var e=c[b].cb({area:a,found:arguments,line:d,pos:f++,uid:[b,d,f,(new Date).getTime()+"RAND"+Math.ceil(1e5*Math.random())].join("-"),replace:function(a){var b=this.area.editor.getLine(this.line),c=b.indexOf(this.found[0]),d=c+this.found[0].length;this.area.editor.replaceRange(a,{line:this.line,ch:c},{line:this.line,ch:d})}});return e})})}(f);this.currentvalue=e.join("\n")}},_buildtoolbar:function(){if(this.options.toolbar&&this.options.toolbar.length){var b=this,c=[];this.options.toolbar.forEach(function(a){if(d.commands[a]){var e=d.commands[a].title?d.commands[a].title:a;c.push('<li><a data-markdownarea-cmd="'+a+'" title="'+e+'" data-toggle="tooltip">'+d.commands[a].label+"</a></li>"),d.commands[a].shortcut&&b.registerShortcut(d.commands[a].shortcut,d.commands[a].action)}}),this.toolbar.html(c.join("\n")),this.markdownarea.on("click","a[data-markdownarea-cmd]",function(){var c=a(this).data("markdownareaCmd");!c||!d.commands[c]||b.activetab&&"code"!=b.activetab&&"fullscreen"!=c||d.commands[c].action.apply(b,[b.editor])})}},fit:function(){var a=this.options.mode;"split"==a&&this.markdownarea.width()<this.options.maxsplitsize&&(a="tab"),"tab"==a&&(this.activetab||(this.activetab="code",this.markdownarea.attr("data-active-tab",this.activetab)),this.markdownarea.find(".uk-markdown-button-markdown, .uk-markdown-button-preview").removeClass("uk-active").filter("code"==this.activetab?".uk-markdown-button-markdown":".uk-markdown-button-preview").addClass("uk-active")),this.editor.refresh(),this.preview.parent().css("height",this.code.height()),this.markdownarea.attr("data-mode",a)},registerShortcut:function(b,c){var d=this;b=a.isArray(b)?b:[b];for(var e=0,f=b.length;f>e;e++){var g={};g[b[e]]=function(){c.apply(d,[d.editor])},d.editor.addKeyMap(g)}},getMode:function(){var a=this.editor.getDoc().getCursor();return this.editor.getTokenAt(a).state.base.htmlState?"html":"markdown"}}),a.fn.markdownarea=function(b){return this.each(function(){var c=a(this);if(!c.data("markdownarea")){new d(c,b)}})};var e=function(a,b){var c=b.getSelection(),d=a.replace("$1",c);b.replaceSelection(d,"end")};return d.commands={fullscreen:{title:"Fullscreen",label:'<i class="fa fa-expand"></i>',action:function(d){d.markdownarea.markdownarea.toggleClass("uk-markdownarea-fullscreen"),a("html").toggleClass("markdownarea-fullscreen"),a("html, body").scrollTop(0);var e=d.getWrapperElement();if(d.markdownarea.markdownarea.hasClass("uk-markdownarea-fullscreen"))d.state.fullScreenRestore={scrollTop:b.pageYOffset,scrollLeft:b.pageXOffset,width:e.style.width,height:e.style.height},e.style.width="",e.style.height=d.markdownarea.content.height()+"px",c.documentElement.style.overflow="hidden";else{c.documentElement.style.overflow="";var f=d.state.fullScreenRestore;e.style.width=f.width,e.style.height=f.height,b.scrollTo(f.scrollLeft,f.scrollTop)}d.refresh(),d.markdownarea.preview.parent().css("height",d.markdownarea.code.height())}},bold:{title:"Bold",label:'<i class="fa fa-bold"></i>',shortcut:["Ctrl-B","Cmd-B"],action:function(a){e("html"==this.getMode()?"<strong>$1</strong>":"**$1**",a)}},italic:{title:"Italic",label:'<i class="fa fa-italic"></i>',action:function(a){e("html"==this.getMode()?"<em>$1</em>":"*$1*",a)}},strike:{title:"Strikethrough",label:'<i class="fa fa-strikethrough"></i>',action:function(a){e("html"==this.getMode()?"<del>$1</del>":"~~$1~~",a)}},blockquote:{title:"Blockquote",label:'<i class="fa fa-quote-right"></i>',action:function(a){e("html"==this.getMode()?"<blockquote><p>$1</p></blockquote>":"> $1",a)}},link:{title:"Link",label:'<i class="fa fa-link"></i>',action:function(a){e("html"==this.getMode()?'<a href="http://">$1</a>':"[$1](http://)",a)}},picture:{title:"Picture",label:'<i class="fa fa-picture-o"></i>',action:function(a){e("html"==this.getMode()?'<img src="http://" alt="$1">':"![$1](http://)",a)}},listUl:{title:"Unordered List",label:'<i class="fa fa-list-ul"></i>',action:function(a){"markdown"==this.getMode()&&e("* $1",a)}},listOl:{title:"Ordered List",label:'<i class="fa fa-list-ol"></i>',action:function(a){"markdown"==this.getMode()&&e("1. $1",a)}}},d.defaults={mode:"split",height:500,maxsplitsize:1e3,codemirror:{mode:"gfm",tabMode:"indent",tabindex:"2",lineWrapping:!0,dragDrop:!1,autoCloseTags:!0,matchTags:!0},toolbar:["bold","italic","strike","link","picture","blockquote","listUl","listOl"],lblPreview:"Preview",lblCodeview:"Markdown"},d.template='<div class="uk-markdownarea uk-clearfix" data-mode="split"><div class="uk-markdownarea-navbar"><ul class="uk-markdownarea-navbar-nav uk-markdownarea-toolbar"></ul><div class="uk-markdownarea-navbar-flip"><ul class="uk-markdownarea-navbar-nav"><li class="uk-markdown-button-markdown"><a>{:lblCodeview}</a></li><li class="uk-markdown-button-preview"><a>{:lblPreview}</a></li><li><a data-markdownarea-cmd="fullscreen" data-toggle="tooltip" title="Zen Mode"><i class="fa fa-expand"></i></a></li></ul></div></div><div class="uk-markdownarea-content"><div class="uk-markdownarea-code"></div><div class="uk-markdownarea-preview"><div></div></div></div></div>',d.plugins={},d.addPlugin=function(a,b,c){d.plugins[a]={identifier:b,cb:c}},a.fn.markdownarea=d,a(function(){a("textarea[data-uk-markdownarea]").each(function(){var b,c=a(this);c.data("markdownarea")||(b=new d(c,a.Utils.options(c.attr("data-uk-markdownarea"))))})}),d}(jQuery,window,document),App.directive("masked",function(){return{restrict:"A",controller:function(a,b){var c=$(b);$.fn.inputmask&&c.inputmask()}}}),App.directive("searchOpen",["navSearch",function(a){"use strict";return{restrict:"A",controller:function(b,c){c.on("click",function(a){a.stopPropagation()}).on("click",a.toggle)}}}]).directive("searchDismiss",["navSearch",function(a){"use strict";var b='.navbar-form input[type="text"]';return{restrict:"A",controller:function(c,d){$(b).on("click",function(a){a.stopPropagation()}).on("keyup",function(b){27==b.keyCode&&a.dismiss()}),$(document).on("click",a.dismiss),d.on("click",function(a){a.stopPropagation()}).on("click",a.dismiss)}}}]),App.directive("notify",function(){function a(a){var b=$(a),c=b.data("message"),d=b.data("options");c||$.error("Notify: No message specified"),$.notify(c,d||{})}return{restrict:"A",controller:function(b,c){c.on("click",function(b){b.preventDefault(),a(c)})}}}),function(a){var b={},c={},d=function(b){return"string"==a.type(b)&&(b={message:b}),arguments[1]&&(b=a.extend(b,"string"==a.type(arguments[1])?{status:arguments[1]}:arguments[1])),new f(b).show()},e=function(a,b){if(a)for(var d in c)a===c[d].group&&c[d].close(b);else for(var d in c)c[d].close(b)},f=function(d){this.options=a.extend({},f.defaults,d),this.uuid="ID"+(new Date).getTime()+"RAND"+Math.ceil(1e5*Math.random()),this.element=a(['<div class="uk-notify-message alert-dismissable">','<a class="close">&times;</a>',"<div>"+this.options.message+"</div>","</div>"].join("")).data("notifyMessage",this),this.options.status&&(this.element.addClass("alert alert-"+this.options.status),this.currentstatus=this.options.status),this.group=this.options.group,c[this.uuid]=this,b[this.options.pos]||(b[this.options.pos]=a('<div class="uk-notify uk-notify-'+this.options.pos+'"></div>').appendTo("body").on("click",".uk-notify-message",function(){a(this).data("notifyMessage").close()}))};return a.extend(f.prototype,{uuid:!1,element:!1,timout:!1,currentstatus:"",group:!1,show:function(){if(!this.element.is(":visible")){var a=this;b[this.options.pos].show().prepend(this.element);var c=parseInt(this.element.css("margin-bottom"),10);return this.element.css({opacity:0,"margin-top":-1*this.element.outerHeight(),"margin-bottom":0}).animate({opacity:1,"margin-top":0,"margin-bottom":c},function(){if(a.options.timeout){var b=function(){a.close()};a.timeout=setTimeout(b,a.options.timeout),a.element.hover(function(){clearTimeout(a.timeout)},function(){a.timeout=setTimeout(b,a.options.timeout)})}}),this}},close:function(a){var d=this,e=function(){d.element.remove(),b[d.options.pos].children().length||b[d.options.pos].hide(),delete c[d.uuid]};this.timeout&&clearTimeout(this.timeout),a?e():this.element.animate({opacity:0,"margin-top":-1*this.element.outerHeight(),"margin-bottom":0},function(){e()})},content:function(a){var b=this.element.find(">div");return a?(b.html(a),this):b.html()},status:function(a){return a?(this.element.removeClass("alert alert-"+this.currentstatus).addClass("alert alert-"+a),this.currentstatus=a,this):this.currentstatus}}),f.defaults={message:"",status:"normal",timeout:5e3,group:null,pos:"top-center"},a.notify=d,a.notify.message=f,a.notify.closeAll=e,d}(jQuery,window,document),App.directive("now",["dateFilter","$interval",function(a,b){return{restrict:"E",link:function(c,d,e){function f(){var b=a(new Date,g);d.text(b)}var g=e.format;f(),b(f,1e3)}}}]),App.directive("paneltool",function(a,b){function c(a,b){var c="";return b=b||{},b.toolCollapse&&(c+=d.collapse.replace(/{{panelId}}/g,a.parent().parent().attr("id"))),b.toolDismiss&&(c+=d.dismiss),b.toolRefresh&&(c+=d.refresh.replace(/{{spinner}}/g,b.toolRefresh)),c}var d={collapse:"<a href='#' panel-collapse='' data-toggle='tooltip' title='Collapse Panel' ng-click='{{panelId}} = !{{panelId}}' ng-init='{{panelId}}=false'>                 <em ng-show='{{panelId}}' class='fa fa-plus'></em>                 <em ng-show='!{{panelId}}' class='fa fa-minus'></em>               </a>",dismiss:"<a href='#' panel-dismiss='' data-toggle='tooltip' title='Close Panel'>               <em class='fa fa-times'></em>             </a>",refresh:"<a href='#' panel-refresh='' data-toggle='tooltip' data-spinner='{{spinner}}' title='Refresh Panel'>               <em class='fa fa-refresh'></em>             </a>"};return{restrict:"E",link:function(d,e,f){var g=d.panelTools||f;b(function(){e.html(c(e,g)).show(),a(e.contents())(d),e.addClass("pull-right")})}}}).directive("panelDismiss",function(a){"use strict";return{restrict:"A",controller:function(b,c){var d="panel-remove",e="panel-removed";c.on("click",function(){function c(){var c=a.defer(),e=c.promise;b.$emit(d,h.attr("id"),c),e.then(f)}function f(){$.support.animation?h.animo({animation:"bounceOut"},g):g()}function g(){var a=h.parent();h.remove(),a.filter(function(){var a=$(this);return a.is('[class*="col-"]:not(.sortable)')&&0===a.children("*").length}).remove(),b.$emit(e,h.attr("id"))}var h=$(this).closest(".panel");c()})}}}).directive("panelCollapse",["$timeout",function(a){"use strict";function b(a,b){if(!a)return!1;var c=angular.fromJson(d[e]);c||(c={}),c[a]=b,d[e]=angular.toJson(c)}function c(a){if(!a)return!1;var b=angular.fromJson(d[e]);return b?b[a]:void 0}var d,e="panelState";return{restrict:"A",controller:function(e,f){var g=$(f),h=g.closest(".panel"),i=h.attr("id");d=e.$storage;var j=c(i);void 0!==typeof j&&a(function(){e[i]=j},10),f.bind("click",function(){b(i,!e[i])})}}}]).directive("panelRefresh",function(){"use strict";return{restrict:"A",controller:function(a,b){function c(a,b){if(b){var c="#"==b.charAt(0)?b:"#"+b;angular.element(c).removeClass(e)}}var d="panel-refresh",e="whirl",f="standard";b.on("click",function(){var b=$(this),c=b.parents(".panel").eq(0),g=b.data("spinner")||f;c.addClass(e+" "+g),a.$emit(d,c.attr("id"))}),a.$on("removeSpinner",c)}}}),App.directive("animate",function(){"use strict";var a=$(window).add("body, .wrapper");return{restrict:"A",link:function(b,c){function d(a){!a.hasClass("anim-running")&&$.Utils.isInView(a,{topoffset:f})&&(a.addClass("anim-running"),setTimeout(function(){a.addClass("anim-done").animo({animation:h,duration:.7})},g))}var e=$(c),f=e.data("offset"),g=e.data("delay")||100,h=e.data("play")||"bounce";"undefined"!=typeof f&&(d(e),a.scroll(function(){d(e)})),e.on("click",function(){var a=$(this),b=a.data("target"),c=a.data("play")||"bounce",d=$(b);d&&d&&d.animo({animation:c})})}}}),App.directive("scrollable",function(){return{restrict:"EA",link:function(a,b,c){var d=250;b.slimScroll({height:c.height||d})}}}),App.directive("sidebar",["$window","APP_MEDIAQUERY",function(a,b){function c(a){a.siblings("li").removeClass("open").end().toggleClass("open")}function d(a){e();var b=a.children("ul");if(!b.length)return $();if(a.hasClass("open"))return c(a),$();var d=$(".aside"),f=i.app.layout.isFixed?parseInt(d.css("padding-top"),0):0,g=b.clone().appendTo(d);c(a);var h=a.position().top+f-j.scrollTop(),l=k.height();return g.addClass("nav-floating").css({position:i.app.layout.isFixed?"fixed":"absolute",top:h,bottom:g.outerHeight(!0)+h>l?0:"auto"}),g.on("mouseleave",function(){c(a),g.remove()}),g}function e(){$(".sidebar-subnav.nav-floating").remove()}function f(){return l.hasClass("touch")}function g(){return m.hasClass("aside-collapsed")}function h(){return k.width()<b.tablet}var i,j,k=$(a),l=$("html"),m=$("body");return{restrict:"EA",template:'<nav class="sidebar" ng-transclude></nav>',transclude:!0,replace:!0,link:function(a,b){i=a,j=b;var c=f()?"click":"mouseenter",k=$();j.on(c,".nav > li",function(){g()&&!h()&&(k.trigger("mouseleave"),k=d($(this)))}),a.$on("closeSidebarMenu",function(){e(),$(".sidebar li.open").removeClass("open")})}}}]),App.directive("skycon",function(){return{restrict:"A",link:function(a,b,c){var d=new Skycons({color:c.color||"white"});b.html('<canvas width="'+c.width+'" height="'+c.height+'"></canvas>'),d.add(b.children()[0],c.skycon),d.play()
}}}),App.directive("sparkline",["$timeout","$window",function(a){"use strict";function b(a){var b=a.data();b.type=b.type||"bar",b.disableHiddenCheck=!0,a.sparkline("html",b),b.resize&&$(window).resize(function(){a.sparkline("html",b)})}return{restrict:"EA",controller:function(c,d){var e=function(){b(d)};a(e)}}}]),App.directive("checkAll",function(){"use strict";return{restrict:"A",controller:function(a,b){b.on("change",function(){var a=$(this),b=a.index()+1,c=a.find('input[type="checkbox"]'),d=a.parents("table");d.find("tbody > tr > td:nth-child("+b+') input[type="checkbox"]').prop("checked",c[0].checked)})}}}),App.directive("tagsinput",function(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){c.on("itemAdded itemRemoved",function(){e.$viewValue&&e.$viewValue.split&&(e.$setViewValue(e.$viewValue.split(",")),e.$render())}),a(function(){c.tagsinput()})}}}),App.directive("toggleState",["toggleStateService",function(a){"use strict";return{restrict:"A",link:function(b,c,d){var e=$("body");$(c).on("click",function(b){b.preventDefault();var c=d.toggleState;c&&(e.hasClass(c)?(e.removeClass(c),d.noPersist||a.removeState(c)):(e.addClass(c),d.noPersist||a.addState(c)))})}}}]),App.directive("uiSlider",function(){return{restrict:"A",controller:function(a,b){var c=$(b);$.fn.slider&&c.slider()}}}),App.directive("validateForm",function(){return{restrict:"A",controller:function(a,b){var c=$(b);$.fn.parsley&&c.parsley()}}}),App.directive("vectorMap",["vectorMap",function(a){"use strict";var b={markerColor:"#23b7e5",bgColor:"transparent",scaleColors:["#878c9a"],regionFill:"#bbbec6"};return{restrict:"EA",link:function(c,d,e){var f=e.height||"300",g={markerColor:e.markerColor||b.markerColor,bgColor:e.bgColor||b.bgColor,scale:e.scale||1,scaleColors:e.scaleColors||b.scaleColors,regionFill:e.regionFill||b.regionFill,mapName:e.mapName||"world_mill_en"};d.css("height",f),a.init(d,g,c.seriesData,c.markersData)}}}]),App.service("browser",function(){"use strict";var a,b,c=function(a){a=a.toLowerCase();var b=/(opr)[\/]([\w.]+)/.exec(a)||/(chrome)[ \/]([\w.]+)/.exec(a)||/(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[],c=/(ipad)/.exec(a)||/(iphone)/.exec(a)||/(android)/.exec(a)||/(windows phone)/.exec(a)||/(win)/.exec(a)||/(mac)/.exec(a)||/(linux)/.exec(a)||/(cros)/i.exec(a)||[];return{browser:b[3]||b[1]||"",version:b[2]||"0",platform:c[0]||""}};if(a=c(window.navigator.userAgent),b={},a.browser&&(b[a.browser]=!0,b.version=a.version,b.versionNumber=parseInt(a.version)),a.platform&&(b[a.platform]=!0),(b.android||b.ipad||b.iphone||b["windows phone"])&&(b.mobile=!0),(b.cros||b.mac||b.linux||b.win)&&(b.desktop=!0),(b.chrome||b.opr||b.safari)&&(b.webkit=!0),b.rv){var d="msie";a.browser=d,b[d]=!0}if(b.opr){var e="opera";a.browser=e,b[e]=!0}if(b.safari&&b.android){var f="android";a.browser=f,b[f]=!0}return b.name=a.browser,b.platform=a.platform,b}),App.factory("colors",["APP_COLORS",function(a){return{byName:function(b){return a[b]||"#fff"}}}]),App.service("gmap",function(){return{setStyle:function(a){this.MapStyles=a},autocenter:function(){var a=this.gMapRefs;if(a&&a.length)for(var b in a){var c=a[b],d=c.getCenter();c&&d&&(google.maps.event.trigger(c,"resize"),c.setCenter(d))}},init:function(a){var b=this,c=$(a),d=c.data("address")&&c.data("address").split(";"),e=c.data("title")&&c.data("title").split(";"),f=c.data("zoom")||14,g=c.data("maptype")||"ROADMAP",h=[];if(d){for(var i in d)"string"==typeof d[i]&&h.push({address:d[i],html:e&&e[i]||"",popup:!0});var j={controls:{panControl:!0,zoomControl:!0,mapTypeControl:!0,scaleControl:!0,streetViewControl:!0,overviewMapControl:!0},scrollwheel:!1,maptype:g,markers:h,zoom:f},k=c.gMap(j),l=k.data("gMap.reference");b.gMapRefs||(b.gMapRefs=[]),b.gMapRefs.push(l),void 0!==c.data("styled")&&l.setOptions({styles:b.MapStyles})}}}}),App.service("navSearch",function(){var a="form.navbar-form";return{toggle:function(){var b=$(a);b.toggleClass("open");var c=b.hasClass("open");b.find("input")[c?"focus":"blur"]()},dismiss:function(){$(a).removeClass("open").find('input[type="text"]').blur().val("")}}}),App.service("toggleStateService",["$rootScope",function(a){var b="toggleState",c={hasWord:function(a,b){return new RegExp("(^|\\s)"+b+"(\\s|$)").test(a)},addWord:function(a,b){return this.hasWord(a,b)?void 0:a+(a?" ":"")+b},removeWord:function(a,b){return this.hasWord(a,b)?a.replace(new RegExp("(^|\\s)*"+b+"(\\s|$)*","g"),""):void 0}};return{addState:function(d){var e=angular.fromJson(a.$storage[b]);e=e?c.addWord(e,d):d,a.$storage[b]=angular.toJson(e)},removeState:function(d){var e=a.$storage[b];e&&(e=c.removeWord(e,d),a.$storage[b]=angular.toJson(e))},restoreState:function(c){var d=angular.fromJson(a.$storage[b]);d&&c.addClass(d)}}}]),function(a,b,c){"use strict";var d=a("html"),e=a(b);a.support.transition=function(){var a=function(){var a,b=c.body||c.documentElement,d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(a in d)if(void 0!==b.style[a])return d[a]}();return a&&{end:a}}(),a.support.animation=function(){var a=function(){var a,b=c.body||c.documentElement,d={WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd oanimationend",animation:"animationend"};for(a in d)if(void 0!==b.style[a])return d[a]}();return a&&{end:a}}(),a.support.requestAnimationFrame=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||b.msRequestAnimationFrame||b.oRequestAnimationFrame||function(a){b.setTimeout(a,1e3/60)},a.support.touch="ontouchstart"in b&&navigator.userAgent.toLowerCase().match(/mobile|tablet/)||b.DocumentTouch&&document instanceof b.DocumentTouch||b.navigator.msPointerEnabled&&b.navigator.msMaxTouchPoints>0||b.navigator.pointerEnabled&&b.navigator.maxTouchPoints>0||!1,a.support.mutationobserver=b.MutationObserver||b.WebKitMutationObserver||b.MozMutationObserver||null,a.Utils={},a.Utils.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},a.Utils.removeCssRules=function(a){var b,c,d,e,f,g,h,i,j,k;a&&setTimeout(function(){try{for(k=document.styleSheets,e=0,h=k.length;h>e;e++){for(d=k[e],c=[],d.cssRules=d.cssRules,b=f=0,i=d.cssRules.length;i>f;b=++f)d.cssRules[b].type===CSSRule.STYLE_RULE&&a.test(d.cssRules[b].selectorText)&&c.unshift(b);for(g=0,j=c.length;j>g;g++)d.deleteRule(c[g])}}catch(l){}},0)},a.Utils.isInView=function(b,c){var d=a(b);if(!d.is(":visible"))return!1;var f=e.scrollLeft(),g=e.scrollTop(),h=d.offset(),i=h.left,j=h.top;return c=a.extend({topoffset:0,leftoffset:0},c),j+d.height()>=g&&j-c.topoffset<=g+e.height()&&i+d.width()>=f&&i-c.leftoffset<=f+e.width()?!0:!1},a.Utils.options=function(b){if(a.isPlainObject(b))return b;var c=b?b.indexOf("{"):-1,d={};if(-1!=c)try{d=new Function("","var json = "+b.substr(c)+"; return JSON.parse(JSON.stringify(json));")()}catch(e){}return d},a.Utils.events={},a.Utils.events.click=a.support.touch?"tap":"click",a.langdirection="rtl"==d.attr("dir")?"right":"left",a(function(){if(a.support.mutationobserver){var b=new a.support.mutationobserver(a.Utils.debounce(function(){a(c).trigger("domready")},300));b.observe(document.body,{childList:!0,subtree:!0})}}),d.addClass(a.support.touch?"touch":"no-touch")}(jQuery,window,document),App.service("vectorMap",function(){"use strict";return{init:function(a,b,c,d){a.vectorMap({map:b.mapName,backgroundColor:b.bgColor,zoomMin:2,zoomMax:8,zoomOnScroll:!1,regionStyle:{initial:{fill:b.regionFill,"fill-opacity":1,stroke:"none","stroke-width":1.5,"stroke-opacity":1},hover:{"fill-opacity":.8},selected:{fill:"blue"},selectedHover:{}},focusOn:{x:.4,y:.6,scale:b.scale},markerStyle:{initial:{fill:b.markerColor,stroke:b.markerColor}},onRegionLabelShow:function(a,b,d){c&&c[d]&&b.html(b.html()+": "+c[d]+" visitors")},markers:d,series:{regions:[{values:c,scale:b.scaleColors,normalizeFunction:"polynomial"}]}})}}}),angular.module("core").config(["$stateProvider","$urlRouterProvider","APP_REQUIRES",function(a,b){"use strict";b.otherwise("/app/dashboard"),a.state("app",{url:"/app","abstract":!0,templateUrl:"modules/core/views/app.html",controller:"AppController",resolve:ApplicationConfiguration.resolve("fastclick","modernizr","icons","screenfull","animo","sparklines","slimscroll","classyloader","toaster","whirl"),access:{requiredLogin:!0}}).state("app.dashboard",{url:"/dashboard",title:"Dashboard",templateUrl:"modules/core/views/dashboard.html",access:{requiredLogin:!0}})}]),angular.module("core").directive("fmAddErrorFor",function(){"use strict";return{link:function(a,b,c){a.$watch(c.fmAddErrorFor,function(d){a.$watch(c.fmAddErrorFor+".$invalid",function(){d.$touched&&d.$invalid&&!d.$pristine?b.addClass("has-error"):b.removeClass("has-error")}),a.$watch(c.fmAddErrorFor+".$touched",function(){d.$touched&&d.$invalid&&!d.$pristine?b.addClass("has-error"):b.removeClass("has-error")})})}}}),angular.module("core").directive("autofocus",["$timeout",function(a){"use strict";return{link:function(b,c){a(function(){c[0].focus()},100)}}}]),angular.module("core").directive("fmClockpicker",function(){"use strict";return{restrict:"A",link:function(a,b){b.clockpicker()}}}),angular.module("core").directive("fmDatepicker",["$timeout",function(){"use strict";return{restrict:"A",require:"?ngModel",scope:{fmDatepickerDatechanged:"&"},link:function(a,b,c){var d=c.fmDatepickerHPosition||"right";b.datepicker({format:c.fmDatepickerFormat||"yyyy-mm-dd",autoclose:!0,orientation:"auto "+d,todayBtn:"linked"}).on("changeDate",function(b){var d=b.format(c.fmDatepickerFormat||"yyyy-mm-dd");a.fmDatepickerDatechanged&&a.$apply(function(){a.fmDatepickerDatechanged({date:d})})})}}}]),angular.module("core").directive("piechart",function(){"use strict";return{restrict:"E",link:function(a,b,c){var d=null,e={series:{pie:{show:!0,radius:1,label:{show:!0,radius:2/3,formatter:function(a,b){return"<div style='font-size:8pt; text-align:center; padding:2px; color:white;'>"+a+"<br/>"+Math.round(b.percent)+"%</div>"},threshold:.1}}},legend:{show:!1}};a.$watch(c.ngModel,function(a){d?(d.setData(a),d.setupGrid(),d.draw()):a&&(d=$.plot(b,a,e),b.show())})}}}),angular.module("core").factory("Account",["$resource",function(a){"use strict";return a("/api/public/accounts/:id",{id:"@id"})}]),angular.module("core").factory("Company",["$resource",function(a){"use strict";return a("/api/public/companies/:id",{id:"@id"})}]),angular.module("core").factory("Invoice",["$resource",function(a){"use strict";return a("/api/public/invoices/:id",{id:"@id"})}]),angular.module("core").factory("Project",["$resource",function(a){"use strict";return a("/api/public/projects/:id",{id:"@id"},{active:{method:"GET",url:"/api/public/projects/active",isArray:!0},hide:{method:"POST",url:"/api/public/projects/:id/hide",isArray:!1},unhide:{method:"POST",url:"/api/public/projects/:id/unhide",isArray:!1},changetasks:{method:"POST",url:"/api/public/projects/:id/changetasks",isArray:!1}})}]),angular.module("core").factory("TimeRegistration",["$resource",function(a){"use strict";return a("/api/public/timeregistrations/:id",{id:"@id"},{bydate:{method:"GET",url:"/api/public/timeregistrations/bydate/:date",params:{date:"@date"},isArray:!0},byrange:{method:"GET",url:"/api/public/timeregistrations/byrange/:from/:to",params:{from:"@from",to:"@to"},isArray:!0},uninvoiced:{method:"GET",url:"/api/public/timeregistrations/uninvoiced",isArray:!0},getinfo:{method:"GET",url:"/api/public/timeregistrations/getinfo/:from/:to",params:{from:"@from",to:"@to"}},save:{method:"POST",url:"/api/public/timeregistrations",isArray:!0}})}]),angular.module("core").factory("XLSXReader",["$q","$rootScope",function(a){"use strict";function b(a){var b={};return _.forEachRight(a.SheetNames,function(d){var e=a.Sheets[d];b[d]=c(e)}),b}function c(a){var b=XLSX.utils.decode_range(a["!ref"]),c=[],d=[];return _.forEachRight(_.range(b.s.r,b.e.r+1),function(e){var f=[];_.forEachRight(_.range(b.s.c,b.e.c+1),function(b){var c=XLSX.utils.encode_cell({c:b,r:e}),d=a[c];f[b]=d?d.v:void 0}),0==e?d=f:c[e-1]=f}),{header:d,data:c,name:a.name,col_size:b.e.c+1,row_size:b.e.r}}var d=function(a){angular.extend(this,a)};return d.readFile=function(c){var d=a.defer(),e=new FileReader;return e.onload=function(a){var c=a.target.result,e=XLSX.read(c,{type:"binary"});d.resolve(b(e))},e.readAsBinaryString(c),d.promise},d}]),angular.module("core").filter("formatdate",function(){"use strict";return function(a){return _.has(a,"year")&&_.has(a,"month")&&_.has(a,"day")?a.year+"-"+("00"+a.month).slice(-2)+"-"+("00"+a.day).slice(-2):"-"}}),angular.module("core").filter("formattime",function(){"use strict";return function(a){if(_.has(a,"hour")&&_.has(a,"minutes"))return("00"+a.hour).slice(-2)+":"+("00"+a.minutes).slice(-2);if(_.isNumber(a)){var b=Math.floor(a/60),c=Math.floor(a-60*b);return b>99?b+":"+("00"+c).slice(-2):("00"+b).slice(-2)+":"+("00"+c).slice(-2)}return"-"}}),angular.module("core").filter("moment",function(){"use strict";return function(a,b){return a.format(b)}}),angular.module("crm").config(["$stateProvider",function(a){"use strict";a.state("app.companies",{url:"/crm/companies",templateUrl:"modules/crm/views/companies.html",controller:"CompaniesController",access:{requiredLogin:!0}})}]),angular.module("crm").controller("CompaniesController",["$scope","$modal","Company",function(a,b,c){"use strict";a.getAllCompanies=function(){a.companies=c.query()},a.openCompany=function(c){var d=b.open({templateUrl:"/modules/crm/views/editcompany.html",controller:"CompanyDialogController",resolve:{toUpdate:function(){return c}}});d.result.then(function(b){var c=_.find(a.companies,{id:b.id});c?angular.copy(b,c):a.companies.push(b)})}}]),angular.module("crm").controller("CompanyDialogController",["$scope","Company","toUpdate",function(a,b,c){"use strict";function d(b){a.isBusy=!0,a.message=b}function e(){a.isBusy=!1,a.message=""}a.originalCompany=c,a.newCompany=void 0==c,c=c||{},a.company={name:c.name||""},a.isBusy=!1,a.message="",a.ok=function(){d("Saving company...");var c=a.newCompany?{}:{id:a.originalCompany.id};b.save(c,a.company,function(b){e(),a.$close(b)},function(){d("An error occurred...")})},a.cancel=function(){a.$dismiss("cancel")}}]),angular.module("project").config(["$stateProvider",function(a){"use strict";a.state("app.projects",{url:"/projects/overview",templateUrl:"modules/project/views/projects.html",controller:"ProjectsController",access:{requiredLogin:!0}})}]),angular.module("project").controller("ProjectDialogController",["$scope","Project","Company","toUpdate",function(a,b,c,d){"use strict";function e(b){a.isBusy=!0,a.message=b}function f(){a.isBusy=!1,a.message=""}a.originalProject=d,a.newProject=void 0==d,d=d||{},a.project={companyId:d.companyId||"",name:d.name||"",description:d.description||""},a.isBusy=!1,a.message="",a.companies=c.query(),a.ok=function(){e("Saving project...");var c=a.newProject?{}:{id:a.originalProject.id};b.save(c,a.project,function(b){f(),a.$close(b)},function(){e("An error occurred...")})},a.cancel=function(){a.$dismiss("cancel")}}]),angular.module("project").controller("ProjectsController",["$scope","$modal","Project",function(a,b,c){"use strict";a.getAllProjects=function(){a.projects=c.query()},a.openProject=function(c){var d=b.open({templateUrl:"/modules/project/views/editproject.html",controller:"ProjectDialogController",resolve:{toUpdate:function(){return c}}});d.result.then(function(b){var c=_.find(a.projects,{id:b.id});c?angular.copy(b,c):a.projects.push(b)})},a.openProjectTasks=function(c){var d=b.open({templateUrl:"/modules/project/views/projecttasksdialog.html",controller:"ProjectTasksDialogController",resolve:{toUpdate:function(){return c}}});d.result.then(function(b){var c=_.find(a.projects,{id:b.id});c&&angular.copy(b,c)})},a.hideProject=function(a){c.hide({id:a.id},function(){a.hidden=!0})},a.unhideProject=function(a){c.unhide({id:a.id},function(){a.hidden=!1})}}]),angular.module("project").controller("ProjectTasksDialogController",["$scope","Project","toUpdate",function(a,b,c){"use strict";function d(b){a.isBusy=!0,a.message=b}function e(){a.isBusy=!1,a.message=""}a.originalProject=c,c=c||{},a.project={tasks:_.map(c.tasks,function(a){return{name:a.name,defaultRateInCents:a.defaultRateInCents}})},a.isBusy=!1,a.message="",a.ok=function(){d("Saving project..."),b.changetasks({id:a.originalProject.id},a.project.tasks,function(b){e(),a.$close(b)},function(){d("An error occurred...")})},a.cancel=function(){a.$dismiss("cancel")}}]),angular.module("time").config(["$stateProvider","$urlRouterProvider",function(a){"use strict";a.state("app.time_overview",{url:"/time/overview/:date",templateUrl:"modules/time/views/overview.html",controller:"OverviewController",access:{requiredLogin:!0},resolve:ApplicationConfiguration.resolve("datetime"),onEnter:function(a,b){b.date||a.go("app.time_overview",{date:(new moment).format("YYYYMMDD")},{location:"replace"})}}).state("app.time_report",{url:"/time/report/:from/:to",templateUrl:"modules/time/views/report.html",controller:"ReportController",access:{requiredLogin:!0},resolve:ApplicationConfiguration.resolve("flot-chart","flot-chart-plugins"),onEnter:function(a,b){b.from&&b.to||a.go("app.time_report",{from:(new moment).startOf("month").format("YYYYMMDD"),to:(new moment).endOf("month").format("YYYYMMDD")},{location:"replace"})}}).state("app.time_import",{url:"/time/import",templateUrl:"modules/time/views/import.html",controller:"ImportController",resolve:ApplicationConfiguration.resolve("excel","ngTable"),access:{requiredLogin:!0}}).state("app.time_export",{url:"/time/export/:from/:to",templateUrl:"modules/time/views/export.html",controller:"ExportController",access:{requiredLogin:!0},resolve:ApplicationConfiguration.resolve("ngTable","datetime"),onEnter:function(a,b){b.from&&b.to||a.go("app.time_export",{from:(new moment).startOf("month").format("YYYYMMDD"),to:(new moment).endOf("month").format("YYYYMMDD")},{location:"replace"})}})}]),angular.module("time").controller("ExportController",["$scope","$location","$stateParams","TimeRegistration",function(a,b,c,d){"use strict";a.from=new moment(c.from,"YYYYMMDD"),a.to=new moment(c.to,"YYYYMMDD"),a.hasTimeRegistrations=!1,a.loading=!1,a.from=new moment(c.from,"YYYYMMDD"),a.to=new moment(c.to,"YYYYMMDD"),a.thisWeek=(new moment).day(1).format("YYYYMMDD")+"/"+(new moment).day(7).format("YYYYMMDD"),a.lastWeek=(new moment).day(1).subtract("days",7).format("YYYYMMDD")+"/"+(new moment).day(7).subtract("days",7).format("YYYYMMDD"),a.thisMonth=(new moment).set("date",1).format("YYYYMMDD")+"/"+(new moment).set("date",(new moment).daysInMonth()).format("YYYYMMDD"),a.lastMonth=(new moment).set("date",1).subtract("months",1).format("YYYYMMDD")+"/"+(new moment).subtract("months",1).set("date",(new moment).subtract("months",1).daysInMonth()).format("YYYYMMDD"),a.thisYear=(new moment).set("month",0).set("date",1).format("YYYYMMDD")+"/"+(new moment).set("month",11).set("date",31).format("YYYYMMDD"),a.lastYear=(new moment).set("month",0).set("date",1).subtract("years",1).format("YYYYMMDD")+"/"+(new moment).set("month",11).set("date",31).subtract("years",1).format("YYYYMMDD"),a.$watch("from",function(){a.displayFrom=a.from.format("YYYY-MM-DD")}),a.$watch("to",function(){a.displayTo=a.to.format("YYYY-MM-DD")}),a.changeFrom=function(b,c){a.from=new moment(b,c)},a.changeTo=function(b,c){a.to=new moment(b,c)},a.applyDate=function(){b.path("/app/time/export/"+a.from.format("YYYYMMDD")+"/"+a.to.format("YYYYMMDD")).replace()},a.refresh=function(){a.loading=!0,d.byrange({from:a.from.format("YYYYMMDD"),to:a.to.format("YYYYMMDD")},function(b){var c=_.groupBy(b,function(a){return a.date.numeric});a.timeRegistrations=_.sortBy(_.map(c,function(a){return{date:_.first(a).date,items:a}}),function(a){return a.date.numeric}),a.hasTimeRegistrations=a.timeRegistrations.length>0,a.loading=!1})}}]),angular.module("time").controller("ImportController",["$scope","$state","XLSXReader","ngTableParams","$filter","Project","TimeRegistration",function(a,b,c,d,e,f,g){"use strict";function h(a){l=[];for(var b=1;a>=b;b++)l[b]=!1}function i(a){for(var b in l)l[b]=!1;l[a]=!0}function j(a){return parseInt(a.replace(/-/g,""),10)}function k(a){return parseInt(a.replace(":",""),10)}var l;a.init=function(){h(4),i(1)},a.active=function(a){return!!l[a]},f.active(function(b){var c=[],d=0;_.forEach(b,function(a){_.forEach(a.tasks,function(b){c.push({project:a,task:b,display:a.name+" - "+b.name,id:d++})})}),a.tasks=c}),a.fileChanged=function(b){a.excelSheets=[],a.excelFile=b[0],c.readFile(a.excelFile,a.showPreview).then(function(b){a.excelSheets=b,i(2)})},a.selectedSheetName=void 0,a.selectedSheet=void 0,a.goto3=function(){a.selectedSheet=a.excelSheets[a.selectedSheetName];for(var b=[],c=0;c<a.selectedSheet.header.length;c++)b.push({key:c,value:a.selectedSheet.header[c]});a.selectedSheetHeader=b,i(3)},a.canGoto3=function(){return null!=a.selectedSheetName},a.goto4=function(){a.groupedRows=_.groupBy(a.selectedSheet.data,function(b){return b[a.selectedProjectColumn]+" - "+b[a.selectedTaskColumn]}),a.projectsInExcelSheet=_.map(a.groupedRows,function(b){return{project:b[0][a.selectedProjectColumn],task:b[0][a.selectedTaskColumn],display:b[0][a.selectedProjectColumn]+" - "+b[0][a.selectedTaskColumn]}}),i(4)},a.canGoto4=function(){return null!=a.selectedProjectColumn&&null!=a.selectedTaskColumn&&null!=a.selectedDateColumn&&null!=a.selectedFromColumn&&null!=a.selectedToColumn&&null!=a.selectedDescriptionColumn},a.goto5=function(){i(5)},a.canGoto5=function(){return _.every(a.projectsInExcelSheet,function(a){return null!=a.mappedProjectAndTask})},a.importing=!1,a["import"]=function(){var b=[];a.importing=!0,_.forEach(a.groupedRows,function(c){var d=_.first(_.where(a.projectsInExcelSheet,function(b){return b.project==c[0][a.selectedProjectColumn]&&b.task==c[0][a.selectedTaskColumn]})).mappedProjectAndTask,e=a.tasks[d].project,f=a.tasks[d].task;_.forEach(c,function(c){b.push({companyId:e.companyId,projectId:e.id,task:f.name,description:c[a.selectedDescriptionColumn],date:j(c[a.selectedDateColumn]),from:k(c[a.selectedFromColumn]),to:k(c[a.selectedToColumn])})})}),g.save(b,function(b){a.importing=!1,a.timeRegistrationsImported=b,a.summaryTableParams.count(10),i(6)},function(){a.importing=!1})},a.summaryTableParams=new d({page:1,count:1},{getData:function(b,c){if(a.timeRegistrationsImported){var d=c.filter()?e("filter")(a.timeRegistrationsImported,c.filter()):a.timeRegistrationsImported,f=c.sorting()?e("orderBy")(d,c.orderBy()):a.timeRegistrationsImported;c.total(f.length),b.resolve(f.slice((c.page()-1)*c.count(),c.page()*c.count()))}}})}]),angular.module("time").controller("OverviewController",["$scope","$modal","$location","$state","$stateParams","TimeRegistration",function(a,b,c,d,e,f){"use strict";a.date=new moment(e.date,"YYYYMMDD"),a.hasTimeRegistrations=!1,a.$watch("date",function(){a.displayDate=a.date.format("YYYY-MM-DD")}),a.nextDate=function(){a.date=new moment(a.date.add(1,"days")),d.go("app.time_overview",{date:a.date.format("YYYYMMDD")},{location:"replace"})},a.previousDate=function(){a.date=new moment(a.date.subtract(1,"days")),d.go("app.time_overview",{date:a.date.format("YYYYMMDD")},{location:"replace"})},a.changeDate=function(b,c){a.date=new moment(b,c),d.go("app.time_overview",{date:a.date.format("YYYYMMDD")},{location:"replace"})},a.refresh=function(){f.bydate({date:a.date.format("YYYYMMDD")},function(b){a.hasTimeRegistrations=b.length>0,a.timeRegistrations=_.sortBy(b,function(a){return a.from.numeric})})},a.openTimeRegistration=function(c){var d=b.open({templateUrl:"/modules/time/views/timeregistrationdialog.html",controller:"TimeRegistrationDialogController",size:"lg",resolve:{toUpdate:function(){return c},date:function(){return a.date.format("YYYYMMDD")}}});d.result.then(function(b){var c=_.find(a.timeRegistrations,{id:b.id});c?angular.copy(b,c):a.timeRegistrations.push(b),a.hasTimeRegistrations=a.timeRegistrations.length>0})}}]),angular.module("time").controller("ReportController",["$scope","$location","$state","$stateParams","TimeRegistration",function(a,b,c,d,e){"use strict";if(a.from=new moment(d.from,"YYYYMMDD"),a.to=new moment(d.to,"YYYYMMDD"),1==a.from.date()&&0==a.from.month()&&31==a.to.date()&&11==a.to.month()&&a.from.year()==a.to.year())a.title=a.from.format("YYYY"),a.previousFrom=new moment(a.from).subtract(1,"year"),a.previousTo=new moment(a.to).subtract(1,"year"),a.nextFrom=new moment(a.from).add(1,"year"),a.nextTo=new moment(a.to).add(1,"year");else if(1==a.from.date()&&new moment(a.from).endOf("month").date()==a.to.date()&&a.from.month()==a.to.month()&&a.from.year()==a.to.year())a.title=a.from.format("MMMM YYYY"),a.previousFrom=new moment(a.from).subtract(1,"month").startOf("month"),a.previousTo=new moment(a.from).subtract(1,"month").endOf("month"),a.nextFrom=new moment(a.from).add(1,"month").startOf("month"),a.nextTo=new moment(a.from).add(1,"month").endOf("month");else{a.title=a.from.format("YYYY-MM-DD")+" - "+a.to.format("YYYY-MM-DD");var f=a.to.diff(a.from,"days")+1;a.previousFrom=new moment(a.from).subtract(f,"days"),a.previousTo=new moment(a.to).subtract(f,"days"),a.nextFrom=new moment(a.from).add(f,"days"),a.nextTo=new moment(a.to).add(f,"days")}a.weekStart=(new moment).startOf("isoWeek").format("YYYYMMDD"),a.weekEnd=(new moment).endOf("isoWeek").format("YYYYMMDD"),a.monthStart=(new moment).startOf("month").format("YYYYMMDD"),a.monthEnd=(new moment).endOf("month").format("YYYYMMDD"),a.yearStart=(new moment).startOf("year").format("YYYYMMDD"),a.yearEnd=(new moment).endOf("year").format("YYYYMMDD"),a.previous=function(){c.go("app.time_report",{from:a.previousFrom.format("YYYYMMDD"),to:a.previousTo.format("YYYYMMDD")},{location:"replace"})},a.next=function(){c.go("app.time_report",{from:a.nextFrom.format("YYYYMMDD"),to:a.nextTo.format("YYYYMMDD")},{location:"replace"})},a.refresh=function(){a.loading=!0,e.getinfo({from:a.from.format("YYYYMMDD"),to:a.to.format("YYYYMMDD")}).$promise.then(function(b){a.summary=b.summary;var c=_.groupBy(b.perTask,function(a){return JSON.stringify({c:a.companyId,p:a.projectId})});a.infoPerProject=_.map(c,function(a){return{companyId:a[0].companyId,company:a[0].company,projectId:a[0].projectId,project:a[0].project,tasks:a}})})["finally"](function(){a.billableUnbillableGraph=[{label:"Billable",data:a.summary.billableMinutes,color:"#7266BA"},{label:"Unbillable",data:a.summary.unBillableMinutes,color:"#5D9CEC"}],a.hasHours=a.summary.unBillableMinutes||a.summary.billableMinutes?!0:!1,a.loading=!1})}}]),angular.module("time").controller("TimeRegistrationDialogController",["$scope","Project","TimeRegistration","toUpdate","date",function(a,b,c,d,e){"use strict";function f(b){a.isBusy=!0,a.message=b}function g(){a.isBusy=!1,a.message=""}function h(a){var b=Math.floor(a/100),c=Math.floor(a-100*b);return("00"+b).slice(-2)+":"+("00"+c).slice(-2)}function i(a){return parseInt(a.replace(":",""),10)}a.originalTimeRegistration=d,a.newTimeRegistration=void 0==d,d=d||{},a.timeRegistration={company:null,project:null,task:null,billable:d.billable||!1,description:d.description||"",from:d.from?h(d.from.numeric):"",to:d.to?h(d.to.numeric):""},a.$watch("timeRegistration.company",function(b,c){c&&b&&c.id!=b.id&&(a.timeRegistration.project=null,a.timeRegistration.task=null)}),a.$watch("timeRegistration.project",function(b,c){c&&b&&c.id!=b.id&&(a.timeRegistration.task=null)}),a.$watch("timeRegistration.task",function(){a.newTimeRegistration&&a.timeRegistration.task&&(a.timeRegistration.billable=a.timeRegistration.task.defaultRateInCents>0)}),a.isBusy=!1,a.message="",a.projects=b.active(function(){a.companies=_.map(_.groupBy(a.projects,function(a){return a.companyId}),function(a){return{id:a[0].companyId,name:a[0].company.name,projects:a}}),d.companyId&&(a.timeRegistration.company=_.first(_.where(a.companies,{id:d.companyId}))),d.projectId&&a.timeRegistration.company&&(a.timeRegistration.project=_.first(_.where(a.timeRegistration.company.projects,{id:d.projectId}))),d.task&&a.timeRegistration.project&&(a.timeRegistration.task=_.first(_.where(a.timeRegistration.project.tasks,{name:d.task}))),a.$apply()}),a.ok=function(){f("Saving time registration...");var b=a.newTimeRegistration?{}:{id:a.originalTimeRegistration.id};c.save(b,{companyId:a.timeRegistration.company.id,projectId:a.timeRegistration.project.id,task:a.timeRegistration.task.name,description:a.timeRegistration.description,billable:a.timeRegistration.billable,date:e,from:i(a.timeRegistration.from),to:i(a.timeRegistration.to)},function(b){g(),a.$close(b)},function(){f("An error occurred...")})},a.cancel=function(){a.$dismiss("cancel")}}]);