<div class="" ng-controller="ImportController">

	<div data-ng-show="wizardStep == 1">
		<div class="form-group">
			<label for="excelFile">Excel File</label>
			<input type="file" name="ExcelFile" accept=".xlsx" onchange="angular.element(this).scope().fileChanged(this.files);">
		</div>
	</div>

	<div data-ng-show="wizardStep == 2">

		<div class='form-group'>
			<label for="selectedSheetName">Sheet Name</label>
			<select id="selectedSheetName" class="form-control" 
					ng-model="selectedSheetName" ng-options="sheetName as sheetName for (sheetName, sheetData) in excelSheets"
					required="true" ng-required="true">
				<option value=""></option>
			</select>
		</div>

		<button type="button" class="btn btn-primary" 
			data-ng-click="gotoStep3()" data-ng-disabled="!canGotoStep3()">Next</button>

		<!-- <table class="table table-bordered">
			<tr ng-repeat="row in selectedSheet.data">
				<td ng-repeat="col in row" ng-bind="col"></td>
			</tr>
		</table> -->
	</div>

	<div data-ng-show="wizardStep == 3">
		<div class="form-group">
			<label for="projectColumn">Project column</label>
			<select id="projectColumn" name="projectColumn" class="form-control"
				 	ng-model="selectedProjectColumn" ng-options="c.key as c.value for c in selectedSheetHeader"
				 	required="true" ng-required="true">
			</select>
		</div>

		<div class="form-group">
			<label for="taskColumn">Task column</label>
			<select id="taskColumn" name="taskColumn" class="form-control"
					ng-model="selectedTaskColumn" ng-options="c.key as c.value for c in selectedSheetHeader"
					required="true" ng-required="true">
			</select>
		</div>

		<div class="form-group">
			<label for="dateColumn">Date column (YYYY-MM-DD)</label>
			<select id="dateColumn" name="dateColumn" class="form-control"
					ng-model="selectedDateColumn" ng-options="c.key as c.value for c in selectedSheetHeader"
					required="true" ng-required="true">
			</select>
		</div>

		<div class="form-group">
			<label for="fromColumn">From column (hh:mm)</label>
			<select id="fromColumn" name="fromColumn" class="form-control"
					ng-model="selectedFromColumn" ng-options="c.key as c.value for c in selectedSheetHeader"
					required="true" ng-required="true">
			</select>
		</div>

		<div class="form-group">
			<label for="toColumn">To column (hh:mm)</label>
			<select id="toColumn" name="toColumn" class="form-control"
					ng-model="selectedToColumn" ng-options="c.key as c.value for c in selectedSheetHeader"
					required="true" ng-required="true">
			</select>
		</div>

		<div class="form-group">
			<label for="descriptionColumn">Description column</label>
			<select id="descriptionColumn" name="descriptionColumn" class="form-control"
					ng-model="selectedDescriptionColumn" ng-options="c.key as c.value for c in selectedSheetHeader"
					required="true" ng-required="true">
			</select>
		</div>
		<button type="button" class="btn btn-primary" 
				data-ng-click="gotoStep4()" data-ng-disabled="!canGotoStep4()">Next</button>
	</div>

	<div data-ng-show="wizardStep == 4">
		<div ng-repeat="p in projectsInExcelSheet">
			{{ p.display }}
			<select class="form-control"
					ng-model="p.mappedProjectAndTask" ng-options="p.id as p.display for p in tasks"
					required="true" ng-required="true">
			</select>
		</div>
		<button type="button" class="btn btn-primary" 
				data-ng-click="gotoStep5()" data-ng-disabled="!canGotoStep5()">Next</button>	
	</div>	

	<div data-ng-show="wizardStep == 5">
		<button type="button" class="btn btn-primary" 
				data-ng-click="import()">Import</button>	
	</div>	
</div>